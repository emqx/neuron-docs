# 概览

## 模块描述

dlt645 驱动支持串口和 TCP 连接。

## 参数配置

### serival

| 字段               | 说明                               |
| ----------------- | -------------------------------- |
| **timeout**       | 向设备发送请求超时时间               |
| **interval**      | 读指令时间间隔，单位为 ms            |
| **device**        | 使用串口设备，例如，/dev/ttyUSB0    |
| **stop**          | 停止位，默认值是 1                  |
| **parity**        | 校验位，默认值是 2，代表偶校验        |
| **baud**          | 波特率，默认值是 9600               |
| **data**          | 数据位，默认值是 8                  |

### TCP

| 字段                 | 说明                                                    |
| ------------------- | ------------------------------------------------------- |
| **timeout**         | 向设备发送请求超时时间               |
| **interval**        | 读指令时间间隔                      |
| **host**            | 当 Neuron 作为客户端使用时，host 指远程设备的 IP。当 Neuron 作为服务端使用时，host 指 Neuron 在本地使用的 IP，默认可填写 0.0.0.0  |
| **port**            | 当 Neuron 作为客户端使用时，post 指远程设备的 TCP 端口。当 Neuron 作为服务端使用时，host 指 Neuron 在本地使用的 TCP 端口  |
| **connection mode** | 驱动程序连接到设备的方式，默认为 client，即把 Neuron 作为客户端使用 |

## 支持的数据类型

* UIN8
* UINT16
* UINT32
* UIN64

## 地址格式用法

### 地址格式

> mail_address#DI<sub>3</sub>-DI<sub>2</sub>-DI<sub>1</sub>-DI<sub>0</sub> </span>

* mail_address 代表电表的通信地址。
* DI<sub>3</sub>-DI<sub>2</sub>-DI<sub>1</sub>-DI<sub>0</sub> 代表的是数据标识，所有点位只支持读属性，且用十六进制表示。

例如，123456789012#02-01-01-00，代表通信地址为 123456789012 的电表设备的 A 相电压的值。

:::tip
一个节点可配置多个通信点位，即支持单串口的多设备连接。

具体的数据标识对应的数据项名称请参考 DL/T645-2007 行业标准的数据编码表格。

* 数据长度为 1，数据类型选择 UINT8；
* 数据长度为 2，数据类型选择 UINT16；
* 数据长度为 3 或 4，数据类型选择 UINT32；
* 数据长度为 5 或 6 或 7 或 8，数据类型选择 UINT64；
* 根据数据格式设置小数位，例如数据格式为 XXX.X，则 Decimal 设置为 0.1；
:::

| DI<sub>3</sub> | DI<sub>2</sub>    | DI<sub>1</sub>   | DI<sub>0</sub>   | 说明                             | 数据类型 | Decimal 值 | 举例                                                         |
| -------------- | ----------------- | ---------------- | --------------- | -------------------------------- | ------- | --------- | ------------------------------------------------------------ |
| 00    | 00 ~ 0A  | 00 ~ 3F | 00 ~ 0C      | DI<sub>3</sub>= 00，代表电能量</br>DI<sub>0</sub>，代表结算日               | UINT64  | 0.01 | 00-00-00-00 代表（当前）组合有功总电能</br>00-00-00-01 代表（上 1 结算日）组合有功总电能 |
| 00    | 80~86</br>15~1E</br>94~9A</br>29~32</br>A8~AE</br>3D~46</br>BC~C2 | 00      | 00 ~ 0C   | DI<sub>3</sub> = 00，代表电能量</br>DI<sub>0</sub>，代表结算日                 | UINT64  | 0.01  | 00-80-00-00 代表（当前）关联总电能</br>00-80-00-01 代表（上 1 结算日）关联总电能</br>00-15-00-01 代表（上 1 结算日）A 相正向有功电能</br>00-15-00-01 代表（上 2 结算日）A 相正向有功电能</br> 00-29-00-02 代表（上 2 结算日）B 相正向有功电能 |
| 02    | 01 ~ 09   | 01 ~ 03  | 00                   | DI<sub>3</sub>= 02，代表变量                                 | UINT16</br>UINT32 | 0.1</br>0.01</br>0.001</br>0.0001 | 02-01-01-00 代表 A 相电压</br>02-02-01-00 代表 A 相电流|
| 02    | 0A ~ 0B   | 01 ~ 03  | 01 ~15               | DI<sub>2</sub>= 0A，代表电压谐波含量</br>DI<sub>2</sub> = 0B，代表电流谐波含量</br>DI<sub>1</sub> ，代表 A，B，C 相</br> DI~0~，代表第几次谐波含量 | UINT16 |  0.01   | 02-0A-01-01 代表 A 相电压 1 次谐波含量</br>02-0A-02-02 代表 B 相电压 2 次谐波含量</br>02-0B-01-01 代表 A 相电流 1 次谐波含量</br>02-0B-02-02 代表 B 相电流 2 次谐波含量 |
| 02    | 80        | 00       | 01 ~ 0A              | DI<sub>3</sub>= 02，代表变量     | UINT16    | 0.01 | 02-80-00-01 代表零线电流 </br>02-80-00-02 代表电网频率     |
| 04    | 00        | 01 ~ 0E  | 01 ~ 0C              | DI<sub>3</sub>= 04，代表参变量   | UINT8</br>UINT16</br>UINT32</br>UINT64  | 0</br>0.1</br>0.001</br>0.0001 | 04-00-01-01 代表日期及时间</br>04-00-01-03 代表最大需量周期</br>04-00-04-01 代表通信地址</br>04-00-05-01 代表电表运行状态字 1 |
| 06    | 00 ~ 06   | 00       | 00 ~ 02              | DI<sub>3</sub>= 06，代表负荷记录  | UINT8</br>UINT64  | 0    | 06-00-00-00 代表最早记录块</br>06-06-00-00 代表第 6 类负荷最早记录块 |